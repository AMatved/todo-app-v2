# üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞—â–∏—Ç–∞ –≤ —ç—Ç–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

### 1. –•—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π

**–ü—Ä–æ–±–ª–µ–º–∞:** –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ –æ–ø–∞—Å–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ–º bcrypt –¥–ª—è —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π.

```javascript
// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è - –ø–∞—Ä–æ–ª—å –ù–ï —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
const passwordHash = await bcrypt.hash(password, 12);
// –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ö—ç—à:
// $2a$12$abcdefghijklmnopqrstuvwxyz...

// –í—Ö–æ–¥ - —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ö—ç—à–∏
const isValid = await bcrypt.compare(enteredPassword, storedHash);
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ:**
- bcrypt –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 4096 –∏—Ç–µ—Ä–∞—Ü–∏–π (cost factor = 12)
- –î–∞–∂–µ –ø—Ä–∏ —É—Ç–µ—á–∫–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –ø–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–æ–ª–∏ –∏–∑ —Ö—ç—à–µ–π –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ
- –ö–∞–∂–¥—ã–π –ø–∞—Ä–æ–ª—å –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—É—é —Å–æ–ª—å (–∑–∞—â–∏—Ç–∞ –æ—Ç rainbow tables)

### 2. JWT —Ç–æ–∫–µ–Ω—ã –≤–º–µ—Å—Ç–æ —Å–µ—Å—Å–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–µ—Å—Å–∏–∏ –≤ –ø–∞–º—è—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ–º JSON Web Tokens.

```javascript
// –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –≤—Ö–æ–¥–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–æ–∫–µ–Ω
const token = jwt.sign({ userId }, SECRET, { expiresIn: '7d' });

// –¢–æ–∫–µ–Ω –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ httpOnly cookie
res.cookie('token', token, {
  httpOnly: true,  // –ó–∞—â–∏—Ç–∞ –æ—Ç XSS (JavaScript –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å)
  secure: true,    // –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ HTTPS
  sameSite: 'strict' // –ó–∞—â–∏—Ç–∞ –æ—Ç CSRF
});
```

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å JWT:**
- –¢–æ–∫–µ–Ω –ø–æ–¥–ø–∏—Å–∞–Ω —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–æ–º (–ø–æ–¥–¥–µ–ª–∫–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞)
- –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω (7 –¥–Ω–µ–π)
- –ü—Ä–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω –º–æ–∂–Ω–æ –æ—Ç–æ–∑–≤–∞—Ç—å, –∏–∑–º–µ–Ω–∏–≤ —Å–µ–∫—Ä–µ—Ç

### 3. HTTPS —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –î–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ –ø–æ HTTP.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ–º HTTPS —Å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º.

```javascript
// –°–µ—Ä–≤–µ—Ä —Å–ª—É—à–∞–µ—Ç –æ–±–∞ –ø–æ—Ä—Ç–∞
http.createServer(app).listen(3000);  // HTTP –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
https.createServer(options, app).listen(3443);  // HTTPS
```

**–ß—Ç–æ —à–∏—Ñ—Ä—É–µ—Ç—Å—è:**
- –ü–∞—Ä–æ–ª–∏ –ø—Ä–∏ –≤–≤–æ–¥–µ
- JWT —Ç–æ–∫–µ–Ω—ã
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á
- Cookies

### 4. Rate Limiting

**–ü—Ä–æ–±–ª–µ–º–∞:** –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å –ø–∞—Ä–æ–ª–∏ (bruteforce).

**–†–µ—à–µ–Ω–∏–µ:** –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤.

```javascript
// –î–ª—è endpoints –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ - —Å—Ç—Ä–æ–≥–∏–π –ª–∏–º–∏—Ç
const authLimiter = rateLimit({
  windowMs: 15 * 60 * 1000,  // 15 –º–∏–Ω—É—Ç
  max: 5,                     // –º–∞–∫—Å–∏–º—É–º 5 –ø–æ–ø—ã—Ç–æ–∫
  message: 'Too many attempts'
});
```

### 5. –ó–∞—â–∏—Ç–∞ –æ—Ç SQL Injection

**–ü—Ä–æ–±–ª–µ–º–∞:** –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π SQL –∫–æ–¥ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º –≤–≤–æ–¥–µ.

**–†–µ—à–µ–Ω–∏–µ:** –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã.

```javascript
// ‚ùå –ù–ï–ë–ï–ó–û–ü–ê–°–ù–û
db.run(`SELECT * FROM users WHERE username = '${username}'`);

// ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û
db.run('SELECT * FROM users WHERE username = ?', [username]);
```

### 6. –ó–∞—â–∏—Ç–∞ –æ—Ç XSS

**–ü—Ä–æ–±–ª–µ–º–∞:** –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π JavaScript –≤ –¥–∞–Ω–Ω—ã—Ö.

**–†–µ—à–µ–Ω–∏—è:**
1. Content Security Policy —á–µ—Ä–µ–∑ Helmet
2. –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

```javascript
// –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞
function escapeHtml(text) {
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}
```

### 7. –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ username
if (!/^[a-zA-Z0-9_]+$/.test(username)) {
  return '–¢–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è';
}

if (username.length < 3 || username.length > 30) {
  return '–î–ª–∏–Ω–∞ –æ—Ç 3 –¥–æ 30 —Å–∏–º–≤–æ–ª–æ–≤';
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ password
if (password.length < 6) {
  return '–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤';
}
```

## –ß–µ–∫-–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:

- [ ] –ò–∑–º–µ–Ω–∏—Ç—å JWT_SECRET –Ω–∞ —Å–ª—É—á–∞–π–Ω—ã–π 256-–±–∏—Ç–Ω—ã–π –∫–ª—é—á
- [ ] –ü–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç–æ—è—â–∏–π SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (Let's Encrypt)
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å NODE_ENV=production
- [ ] –í–∫–ª—é—á–∏—Ç—å secure cookies (SECURE_COOKIES=true)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ñ–∞–π—Ä–≤–æ–ª (–æ—Ç–∫—Ä—ã—Ç—å —Ç–æ–ª—å–∫–æ 80/443 –ø–æ—Ä—Ç—ã)
- [ ] –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`npm audit fix`)

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ:

- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—åÂèçÂêë‰ª£ÁêÜ (Nginx)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- [ ] –í–Ω–µ–¥—Ä–∏—Ç—å 2FA (–¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é)
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å prepared statements –¥–ª—è –≤—Å–µ—Ö SQL –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤ (body-parser limit)
- [ ] –í–Ω–µ–¥—Ä–∏—Ç—å CORS —Å whitelist –¥–æ–º–µ–Ω–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å CAPTCHA –Ω–∞ —Ñ–æ—Ä–º—É –≤—Ö–æ–¥–∞
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [JWT Best Practices](https://tools.ietf.org/html/rfc8725)
- [bcrypt Documentation](https://github.com/kelektiv/node.bcrypt.js)
- [Express Security Best Practices](https://expressjs.com/en/advanced/best-practice-security.html)

## –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### Q: –ü–æ—á–µ–º—É bcrypt, –∞ –Ω–µ SHA256?
A: bcrypt —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è –ø–∞—Ä–æ–ª–µ–π –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç "–º–µ–¥–ª–µ–Ω–Ω—ã–π" –∞–ª–≥–æ—Ä–∏—Ç–º —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏. SHA256 - –±—ã—Å—Ç—Ä—ã–π —Ö—ç—à, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ —É—è–∑–≤–∏–º—ã–º –¥–ª—è bruteforce.

### Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å localStorage –¥–ª—è —Ç–æ–∫–µ–Ω–∞?
A: –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è. localStorage —É—è–∑–≤–∏–º –¥–ª—è XSS. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ httpOnly cookies (–∫–∞–∫ –≤ —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ).

### Q: –ü–æ—á–µ–º—É —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç?
A: –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Let's Encrypt (–±–µ—Å–ø–ª–∞—Ç–Ω–æ) –∏–ª–∏ –ø–ª–∞—Ç–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç.

### Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ —É—Ç–µ—á–∫–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö?
A: –î–∞–∂–µ –ø—Ä–∏ —É—Ç–µ—á–∫–µ, –ø–∞—Ä–æ–ª–∏ –∑–∞—â–∏—â–µ–Ω—ã bcrypt. –ù–æ –Ω—É–∂–Ω–æ:
1. –°—Ä–æ—á–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å JWT_SECRET
2. –û—Ç–æ–∑–≤–∞—Ç—å –≤—Å–µ —Ç–æ–∫–µ–Ω—ã (—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞)
3. –ó–∞—Å—Ç–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª–∏
4. –£–≤–µ–¥–æ–º–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–µ
